---
interface Props {
  showLogin?: boolean;
  isMobile?: boolean;
}

const { showLogin = true, isMobile = false } = Astro.props;
---

<aside class="w-full">
  {showLogin && (
    <div class="bg-white border border-neutral-200 rounded-md p-4 mb-6">
      <h3 class="text-lg font-medium text-neutral-800 mb-2">SegmentFault 思否</h3>
      <p class="text-sm text-neutral-600 mb-4">为开发者提供高效、高质的技术问答和优质内容，助力开发者成长。</p>
      <a
        href="/user/login"
        class="block w-full text-center bg-primary-500 text-white py-2 rounded hover:bg-primary-600 transition"
      >
        注册登录
      </a>
    </div>
  )}

  <!-- 热门标签 -->
  <div class="bg-white border border-neutral-200 rounded-md p-4 mb-6">
    <h3 class="text-base font-medium text-neutral-800 mb-4 flex items-center justify-between">
      <span>热门标签</span>
      <a href="/tags" class="text-sm text-primary-500 hover:underline">更多 ›</a>
    </h3>
    <div class="grid grid-cols-2 sm:grid-cols-1 md:grid-cols-2 gap-2">
      <a href="/t/javascript" class="text-sm text-neutral-600 hover:text-primary-500 truncate">javascript</a>
      <a href="/t/python" class="text-sm text-neutral-600 hover:text-primary-500 truncate">python</a>
      <a href="/t/node.js" class="text-sm text-neutral-600 hover:text-primary-500 truncate">node.js</a>
      <a href="/t/react" class="text-sm text-neutral-600 hover:text-primary-500 truncate">react</a>
      <a href="/t/vue.js" class="text-sm text-neutral-600 hover:text-primary-500 truncate">vue.js</a>
      <a href="/t/php" class="text-sm text-neutral-600 hover:text-primary-500 truncate">php</a>
      <a href="/t/java" class="text-sm text-neutral-600 hover:text-primary-500 truncate">java</a>
      <a href="/t/mysql" class="text-sm text-neutral-600 hover:text-primary-500 truncate">mysql</a>
    </div>
  </div>

  <!-- 热门用户 -->
  <div class="bg-white border border-neutral-200 rounded-md p-4 mb-6">
    <h3 class="text-base font-medium text-neutral-800 mb-4 flex items-center justify-between">
      <span>7 天内最赞</span>
      <a href="/users" class="text-sm text-primary-500 hover:underline">更多 ›</a>
    </h3>
    <ul class="space-y-3">
      <li class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 rounded-full bg-neutral-200 mr-2"></div>
          <a href="/u/user1" class="text-sm text-neutral-600 hover:text-primary-500">用户名1</a>
        </div>
        <span class="text-xs text-primary-500">+47</span>
      </li>
      <li class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 rounded-full bg-neutral-200 mr-2"></div>
          <a href="/u/user2" class="text-sm text-neutral-600 hover:text-primary-500">用户名2</a>
        </div>
        <span class="text-xs text-primary-500">+46</span>
      </li>
      <li class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 rounded-full bg-neutral-200 mr-2"></div>
          <a href="/u/user3" class="text-sm text-neutral-600 hover:text-primary-500">用户名3</a>
        </div>
        <span class="text-xs text-primary-500">+31</span>
      </li>
      <li class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 rounded-full bg-neutral-200 mr-2"></div>
          <a href="/u/user4" class="text-sm text-neutral-600 hover:text-primary-500">用户名4</a>
        </div>
        <span class="text-xs text-primary-500">+28</span>
      </li>
      <li class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 rounded-full bg-neutral-200 mr-2"></div>
          <a href="/u/user5" class="text-sm text-neutral-600 hover:text-primary-500">用户名5</a>
        </div>
        <span class="text-xs text-primary-500">+26</span>
      </li>
    </ul>
  </div>

  <!-- 信息卡片 - 只在非移动端时显示 -->
  <div class="bg-white border border-neutral-200 rounded-md p-4 hidden sm:block">
    <h3 class="text-base font-medium text-neutral-800 mb-4">推荐内容</h3>
    <div class="bg-neutral-100 rounded-md p-4 flex items-center justify-center h-32 text-neutral-500">
      广告位展示区域
    </div>
  </div>

  <!-- 移动端底部操作栏 - 只在移动端时显示 -->
  <div id="mobile-action-bar" class="fixed bottom-0 left-0 right-0 bg-white border-t border-neutral-200 p-3 flex justify-around z-30 sm:hidden">
    <a href="/" class="text-center flex flex-col items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-primary-500" viewBox="0 0 20 20" fill="currentColor">
        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
      </svg>
      <span class="text-xs mt-1">首页</span>
    </a>
    <a href="/questions" class="text-center flex flex-col items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-neutral-500" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
      </svg>
      <span class="text-xs mt-1">问答</span>
    </a>
    <a href="/ask" class="text-center flex flex-col items-center">
      <div class="bg-primary-500 rounded-full p-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
        </svg>
      </div>
      <span class="text-xs mt-1">提问</span>
    </a>
    <a href="/blogs" class="text-center flex flex-col items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-neutral-500" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" />
      </svg>
      <span class="text-xs mt-1">博客</span>
    </a>
    <a href="/user/login" class="text-center flex flex-col items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-neutral-500" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
      </svg>
      <span class="text-xs mt-1">我的</span>
    </a>
  </div>
</aside>

<style>
  /* 为底部导航栏添加安全区域的间距 */
  @supports (padding-bottom: env(safe-area-inset-bottom)) {
    #mobile-action-bar {
      padding-bottom: calc(0.75rem + env(safe-area-inset-bottom));
    }
  }

  /* 为底部导航栏添加额外的底部空间 */
  @media (max-width: 640px) {
    body {
      padding-bottom: 4rem;
    }
  }
</style>

<script>
  // 标记当前活动菜单项
  document.addEventListener('DOMContentLoaded', () => {
    const path = window.location.pathname;
    const actionBar = document.getElementById('mobile-action-bar');

    if (actionBar) {
      const links = actionBar.querySelectorAll('a');
      links.forEach(link => {
        const href = link.getAttribute('href');
        if (href === '/' && path === '/') {
          // 首页
          link.querySelector('svg')?.classList.remove('text-neutral-500');
          link.querySelector('svg')?.classList.add('text-primary-500');
          link.querySelector('span')?.classList.add('text-primary-500');
        } else if (href !== '/' && path.startsWith(href)) {
          // 其他页面
          link.querySelector('svg')?.classList.remove('text-neutral-500');
          link.querySelector('svg')?.classList.add('text-primary-500');
          link.querySelector('span')?.classList.add('text-primary-500');
        }
      });
    }
  });
</script>
